<strong style="color: red; ">
※ 現在学習中で間違った内容を記載している可能性が大いにあります。もし間違いがありましたら、遠慮なくご指摘くださいませ。
</strong>

# ELB

ELB（ElasticLoadBalancing）の説明の前にサービスの基本的な運用方法について、私の理解を説明します。

まず、サービス運用するさいに重要なことは、そのサービスが安定しているか？ということです。

例えば、1台のEC2で運用するようなサービスは、そこに負荷がかかって処理が追いつかなくなり、サービスが落ちる可能性があると思います。つまりそこが、単一の障害点になっている状態です。

この状態を避けるために、サービス運用は冗長化する必要があります。冗長化とは、複数台のEC2を立てて負荷を分散させて運用するような仕組みのことです。

では、負荷をどのような流れで分散させるのでしょうか？

ここでELBの登場です。

ELBは、複数のEC2と接続することで、冗長化したサービスの負荷を自動で分散してくれます。

### 特徴

#### ヘルスチェック
接続されたEC2に対して、チェックが正常なら負荷を振り分けて、異常なら負荷を振り分けない。

#### 負荷分散
初めの説明のような形で負荷分散を行う。同一リージョン内の複数のAZにまたがるEC2に対して負荷分散を行うことができる。

#### セキュリティ
直接サービスへアクセスさせることはセキュリティ上よろしくない。ELBには、DNSのアクセスポイントが用意されているため、外部からのアクセスポイントを一つにすることができる。そのさい、httpsでロードバランサーが受けて（証明書をELBに適用）、そこから内部への通信をhttpで行うというような設定にする。

#### ログのバックアップ
アクセスログをS3に保存することができる。

### タイプ

#### ALB
- 一般的にこちらを用いる
- L7リバースプロキシ
    - アプリケーション層
    - URLやHTTPヘッダーで負荷分散可能（一つのURLでのパスルーティング）
- HTTP（S）に対応

#### NLB
- 大量の処理を捌くのに向いている
- L4 NATロードバランサー
    - トランスポート層
    - IPアドレスとポート番号による負荷分散が可能
- TCPに対応
    - TCPとは通信相手に確実にデータが届いたかをその都度確認する通信方法

#### CLB
以前使われていたタイプ。今後は機能の追加もなく、特に理由がなければ使用しない。